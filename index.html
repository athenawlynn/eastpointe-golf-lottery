<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Eastpointe Weekly Group Selector</title>
<style>
  :root { --green:#0e7a32; }

  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    margin: 0; padding: 24px;
    min-height: 100vh;
    background: url('golf-bg.jpg') center/cover fixed no-repeat;
    position: relative;
  }
  body::before{
    content:"";
    position:fixed; inset:0;
    background: rgba(0,0,0,.35);
    z-index:-1;
  }

  .wrap { max-width: 900px; margin: 0 auto; text-align:center; }

  .logo {
    width: 260px; max-width: 50%;
    margin: 12px auto 20px auto;
    display:block;
    filter: drop-shadow(0 4px 10px rgba(0,0,0,.45)) brightness(1.1);
  }

  h1 {
    font-size: 36px;
    color:#fff;
    font-weight: 800;
    margin: 0 0 24px;
    letter-spacing: 0.5px;
    text-shadow:0 3px 8px rgba(0,0,0,.7);
  }

  .card {
    background: rgba(255,255,255,.92);
    border-radius: 14px; padding: 16px;
    box-shadow: 0 12px 30px rgba(0,0,0,.18);
    margin-bottom: 16px;
    text-align:left;
    backdrop-filter: blur(2px);
  }

  .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  @media (max-width: 800px){ .row{ grid-template-columns: 1fr; } }

  label { font-weight: 600; display:block; margin-bottom: 8px; }
  textarea, input, select {
    width: 100%; box-sizing: border-box; border-radius: 10px;
    border: 1px solid #d9dde6; padding: 12px; font-size: 15px;
    background: #fbfcfe;
  }
  .hint { font-size: 12px; color: #667085; margin-top: 6px; }
  .btn {
    background: var(--green); color: #fff; border: none; border-radius: 10px;
    padding: 12px 16px; font-size: 16px; cursor: pointer;
    box-shadow: 0 6px 16px rgba(14,122,50,.25);
  }
  .btn:disabled { opacity: .6; cursor: not-allowed; }

  .results {
    white-space: pre-wrap;
    font-family: ui-monospace, Menlo, Consolas, monospace;
    margin-top: 20px;
  }

  /* Center message box */
  .error, .ok {
    border-radius: 10px; padding: 14px 16px; margin: 20px auto;
    width: fit-content; font-weight: 600;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0,0,0,.1);
    animation: toast-in 280ms ease-out forwards;
  }
  .error {
    background: #fff2f2;
    color: #b42318;
    border: 1px solid #f4c7c7;
    animation: toast-in 280ms ease-out forwards, toast-attn 420ms 320ms ease-out 1;
  }
  .ok {
    background: #effaf3;
    color: #0f5132;
    border: 1px solid #bfe6cf;
  }

  /* Toast animations */
  @keyframes toast-in {
    0%   { opacity: 0; transform: translateY(6px) scale(0.98); }
    100% { opacity: 1; transform: translateY(0)   scale(1); }
  }
  @keyframes toast-attn {
    0%,100% { transform: translateY(0); }
    20% { transform: translateY(-2px); }
    40% { transform: translateY(2px); }
    60% { transform: translateY(-1px); }
    80% { transform: translateY(1px); }
  }
</style>
</head>
<body>
  <div class="wrap">
    <img src="logo.png" alt="Eastpointe" class="logo" />
    <h1 id="pageTitle">Eastpointe Weekly Group Selector</h1>

    <div class="card">
      <div class="row">
        <div>
          <label for="players">Players (one per line)</label>
          <textarea id="players" rows="10" placeholder="Athena
Victoria
Nancy
Jackie
Sandi
Beth
Tracy
Sharon
Lynne
Maureen S
..."></textarea>
          <div class="hint">Tip: press Enter after each name. Don’t add tee times here.</div>
        </div>

        <div>
          <label for="noPair">Do-Not-Pair (one pair per line; use “Name A - Name B”)</label>
          <textarea id="noPair" rows="10" placeholder="Athena - Victoria
Nancy - Tracy"></textarea>
          <div class="hint">These pairs will never be placed on the same team (unless you check the ignore box).</div>
        </div>
      </div>

      <div class="row" style="align-items:end;">
        <div>
          <label for="teamSize">Team size</label>
          <select id="teamSize">
            <option value="4" selected>4</option>
            <option value="3">3</option>
            <option value="2">2</option>
          </select>
          <div class="hint">Pick 4 for foursomes.</div>

          <label style="margin-top:12px; display:flex; align-items:center; gap:8px;">
            <input type="checkbox" id="ignoreCriteria" />
            Ignore Do-Not-Pair Criteria (allow anyone to ride together)
          </label>
        </div>

        <div style="text-align:right">
          <button id="generateBtn" class="btn">Generate Teams</button>
        </div>
      </div>
    </div>

    <!-- Middle notification message -->
    <div id="msg"></div>

    <div class="card">
      <label>Results</label>
      <div id="results" class="results"></div>
    </div>
  </div>

<script>
function normalizeName(s){return s.trim().replace(/\s+/g,' ');}
function keyPair(a,b){const A=normalizeName(a).toLowerCase();const B=normalizeName(b).toLowerCase();return A<B?A+'|'+B:B+'|'+A;}
function parsePlayers(raw){return raw.split(/[\r\n,]+/).map(normalizeName).filter(Boolean);}
function parseNoPair(raw){const set=new Set();raw.split(/\r?\n/).forEach(line=>{const m=line.split(/\s*-\s*/);if(m.length===2){const a=normalizeName(m[0]);const b=normalizeName(m[1]);if(a&&b)set.add(keyPair(a,b));}});return set;}
function hasConflictWithTeam(name,team,forbidden){return team.some(member=>forbidden.has(keyPair(name,member)));}
function shuffle(arr){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function buildTeams(players,teamSize,forbidden){const pool=shuffle(players);const teams=[];function tryPlace(idx){if(idx>=pool.length)return true;const p=pool[idx];for(let t=0;t<teams.length;t++){if(teams[t].length<teamSize&&!hasConflictWithTeam(p,teams[t],forbidden)){teams[t].push(p);if(tryPlace(idx+1))return true;teams[t].pop();}}teams.push([p]);if(tryPlace(idx+1))return true;teams.pop();return false;}return tryPlace(0)?teams:null;}
const playersEl=document.getElementById('players');
const noPairEl=document.getElementById('noPair');
const teamSizeEl=document.getElementById('teamSize');
const ignoreEl=document.getElementById('ignoreCriteria');
const msgEl=document.getElementById('msg');
const resultsEl=document.getElementById('results');
const generateBtn=document.getElementById('generateBtn');
function showMsg(text,type='ok'){msgEl.innerHTML=`<div class="${type}">${text}</div>`;}
function clearMsg(){msgEl.innerHTML='';}
function formatTeams(teams){return teams.map((team,i)=>`Team ${i+1} (${team.length}): ${team.join(', ')}`).join('\n');}
generateBtn.addEventListener('click',()=>{
  clearMsg();
  const players=parsePlayers(playersEl.value);
  const teamSize=parseInt(teamSizeEl.value,10);
  if(players.length===0){showMsg('❌ Please enter at least one player.','error');resultsEl.textContent='';return;}
  const ignore=ignoreEl.checked;
  const forbidden=ignore?new Set():parseNoPair(noPairEl.value);
  const ATTEMPTS=40;let solution=null;
  for(let k=0;k<ATTEMPTS&&!solution;k++){solution=buildTeams(players,teamSize,forbidden);}
  if(!solution){showMsg('❌ Could not satisfy the “Do-Not-Pair” rules. Try relaxing a pair or changing team size.','error');resultsEl.textContent='';return;}
  resultsEl.textContent=formatTeams(solution);
  showMsg(ignore?'✅ Teams generated (criteria ignored).':'✅ Teams generated with Do-Not-Pair rules applied.','ok');
});
</script>
</body>
</html>
